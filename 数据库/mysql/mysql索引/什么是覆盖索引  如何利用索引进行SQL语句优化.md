如果你不知道什么是覆盖索引，那么 SQL 性能优化便无从谈起！

什么是覆盖索引?如何利用索引进行 SQL 语句优化？

什么叫做覆盖索引？

- 解释一： 就是 select 的数据列只用从索引中就能够取得，不必从数据表中读取，换句话说查询列要被所使用的索引覆盖。
- 解释二： 索引是高效找到行的一个方法，当能通过检索索引就可以读取想要的数据，那就不需要再到数据表中读取行了。如果一个索引包含了（或覆盖了）满足查询语句中字段与条件的数据就叫做覆盖索引。
- 解释三：是非聚集组合索引的一种形式，它包括在查询里的 Select、Join 和 Where 子句用到的所有列（即建立索引的字段正好是覆盖查询语句 [select 子句] 与查询条件 [Where 子句] 中所涉及的字段，也即，索引包含了查询正在查找的所有数据）。

表结构

![](assets/什么是覆盖索引%20%20如何利用索引进行SQL语句优化/file-20251124154304565.png)

150 多万的数据，这么一个简单的语句：

![](assets/什么是覆盖索引%20%20如何利用索引进行SQL语句优化/file-20251124154314885.png)

慢查询日志里居然很多用了 1 秒的，Explain 的结果是：

![](assets/什么是覆盖索引%20%20如何利用索引进行SQL语句优化/file-20251124154323838.png)

从 Explain 的结果可以看出，查询已经使用了索引，但为什么还这么慢？

分析：首先，该语句 ORDER BY 使用了 Using filesort 文件排序，查询效率低；其次，查询字段不在索引上，没有使用覆盖索引，需要通过索引回表查询；也有数据分布的原因。

知道了原因，那么问题就好解决了。

解决方案：由于只需查询 uid 字段，添加一个联合索引便可以避免回表和文件排序，利用覆盖索引提升查询速度，同时利用索引完成排序。

![](assets/什么是覆盖索引%20%20如何利用索引进行SQL语句优化/file-20251124154333613.png)

覆盖索引：SQL 只需要通过索引就可以返回查询所需要的数据，而不必通过二级索引查到主键之后再去查询数据。

我们再 Explain 看一次：

![](assets/什么是覆盖索引%20%20如何利用索引进行SQL语句优化/file-20251124154343081.png)

Extra 信息已经有 'Using Index'，表示已经使用了覆盖索引。经过索引优化之后，线上的查询基本不超过 0.001 秒。
